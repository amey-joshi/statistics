---
title: "Analysis of chicken weight"
author: "Amey Joshi"
date: "20/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
The data describing the effect of certain choices of diet on weight of chicken
is part of every R installation. We first find out how many diet plans were
examined.
```{r}
unique(ChickWeight$Diet)
```

For each diet plan, we will see the variation in the chicken's weight from its
birth to the twentieth day. This is for diet 1.
```{r}
chicks <-
  as.numeric(unique(ChickWeight[ChickWeight$Diet == 1,]$Chick))
coplot(
  weight ~ Time |
    Chick,
  data = ChickWeight,
  given.values = chicks,
  type = "l",
  show.given = FALSE,
  xlab = c("Time", "Chicken on diet 1"),
  ylab = c("Weight")
)
```

Some chickens showed a modest rise in weight but many did not. A few of them 
do not have data for all twenty days, perhaps they did not survive.

For diet 2 it is
```{r}
chicks <-
  as.numeric(unique(ChickWeight[ChickWeight$Diet == 2,]$Chick))
coplot(
  weight ~ Time |
    Chick,
  data = ChickWeight,
  given.values = chicks,
  type = "l",
  show.given = FALSE,
  xlab = c("Time", "Chicken on diet 2"),
  ylab = c("Weight")
)
```

Barring one, all chickens gained weight in twenty days - some substantially, 
others more modestly.

For diet 3 it is
```{r}
chicks <-
  as.numeric(unique(ChickWeight[ChickWeight$Diet == 3,]$Chick))
coplot(
  weight ~ Time |
    Chick,
  data = ChickWeight,
  given.values = chicks,
  type = "l",
  show.given = FALSE,
  xlab = c("Time", "Chicken on diet 3"),
  ylab = c("Weight")
)
```

Every chicken gained weight, though not to the same extent.

Finally, for diet 4 the data is
```{r}
chicks <-
  as.numeric(unique(ChickWeight[ChickWeight$Diet == 4,]$Chick))
coplot(
  weight ~ Time |
    Chick,
  data = ChickWeight,
  given.values = chicks,
  type = "l",
  show.given = FALSE,
  xlab = c("Time", "Chicken on diet 4"),
  ylab = c("Weight")
)
```

The weight gain through diet 4 is monotonous in all but one case. One of the 
chickens does not have data beyong 18 days suggesting a case of mortality.

We will now analyze the efficacy of the four diets using ANOVA. In order to 
do that, we first find the weight gain for each bird.
```{r}
gain <- function(x) {
  x[length(x)] - x[1]
}

X <- with(ChickWeight, tapply(weight, Chick, gain))
weight.gain <- data.frame(Chick = names(X), gain = X)
rm(X)
```

We then merge this data with the main data set to get the weight gain by a 
bird for a diet.
```{r}
X <- merge(weight.gain, ChickWeight, by.x = "Chick", by.y = "Chick")
anova.data <- unique(X[, c("gain", "Chick", "Diet")])
rm(X)
```

An ANOVA will tell if if the null hypothesis that all diets led to an equal
weight gain is true.
```{r}
oneway.test(gain ~ Diet, data = anova.data, var.equal = TRUE)
```

The very small value of making a type I error indicates that we can reject the
null hypothesis.
